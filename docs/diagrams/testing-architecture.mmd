graph TB
    subgraph "Testable Pure Functions"
        style PF1 fill:#90EE90
        style PF2 fill:#90EE90
        style PF3 fill:#90EE90
        style PF4 fill:#90EE90

        PF1[parseCommits<br/>commits → entries]
        PF2[groupByType<br/>entries → grouped]
        PF3[createChangelog<br/>data → changelog]
        PF4[formatChangelogMarkdown<br/>changelog → markdown]
    end

    subgraph "File Organization"
        style Formatters fill:#FFE4B5
        style Service fill:#FFB6C1

        Formatters[utils/changelog-formatters.ts<br/>Pure Functions + Types]
        Service[services/changelog.service.ts<br/>Effect Service]

        Formatters --> PF1
        Formatters --> PF2
        Formatters --> PF3
        Formatters --> PF4
        Service --> Formatters
    end

    subgraph "Test Suite"
        style Tests fill:#87CEEB

        Tests[changelog-formatters.test.ts<br/>Unit Tests for Pure Functions]
        IntTests[Integration Tests<br/>Effect Service Tests]

        Tests --> Formatters
        IntTests --> Service
    end

    subgraph "Benefits of This Architecture"
        style B1 fill:#FAFAD2
        style B2 fill:#FAFAD2
        style B3 fill:#FAFAD2
        style B4 fill:#FAFAD2

        B1[✅ Easy to test<br/>No mocking needed]
        B2[✅ Reusable functions<br/>Can use outside Effect]
        B3[✅ Clear separation<br/>Logic vs. Infrastructure]
        B4[✅ Simple structure<br/>Consistent with other services]
    end

    PF1 -.-> B1
    PF2 -.-> B1
    PF3 -.-> B2
    PF4 -.-> B2
    Formatters -.-> B4
    Service -.-> B3

    classDef pure fill:#90EE90,stroke:#228B22,stroke-width:2px
    classDef test fill:#87CEEB,stroke:#4682B4,stroke-width:2px
    classDef benefit fill:#FAFAD2,stroke:#FFD700,stroke-width:2px

    class PF1,PF2,PF3,PF4 pure
    class Tests,IntTests test
    class B1,B2,B3,B4 benefit
